(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{55371:(e,s,r)=>{"use strict";r.d(s,{e:()=>l});let a=JSON.parse('{"rE":"0.0.15","h_":"Support for multiple file types and sizes"}'),l={name:"File Uploader",description:a.h_,version:a.rE,githubOrgUrl:"https://github.com/Mela-Digital",githubRepoUrl:"https://github.com/Mela-Digital/file-uploader"}},79537:(e,s,r)=>{Promise.resolve().then(r.bind(r,94094))},90603:(e,s,r)=>{"use strict";r.d(s,{Jj:()=>n,aX:()=>t,es:()=>a,uB:()=>l});let a={LATEST_VERSION:"latestVersion",FILES:"files",DELETE_FILE:"deleteFile",APP_CONNECT:"appConnect",REMOVE_FILE:"removeFile",GET_FILE_NAME:"getFileName",VERIFY_DOWNLOAD_LINK:"verifyDownloadLink"},l={DEFAULT_STALE_TIME:6e4,CHECKING_LATEST_VERSION:6e5};var t=function(e){return e.READ="read",e.WRITE="write",e.DELETE="delete",e.UPLOAD="upload",e}({});let n=["read","write","delete","upload"]},94094:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>ex});var a=r(12694),l=r(63478),t=r(72849),n=r(77028),i=r(11387),o=r(83034),c=r(1660),d=r(55371),h=r(90603),m=r(13431),x=r(79630),u=r(47515),p=r.n(u);let f=()=>(0,a.jsxs)("div",{children:[(0,a.jsx)(p(),{href:"/",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(m.default,{src:"/images/file-uploader.png",alt:"Logo",width:32,height:32,className:"filter brightness-400"}),(0,a.jsx)("h1",{className:"text-xl font-bold",children:"File Uploader"})]})}),(0,a.jsxs)("p",{className:"text-xs",children:["Version: ",d.e.version," by"," ",(0,a.jsx)("a",{className:"hover:underline font-bold",href:d.e.githubOrgUrl,target:"_blank",children:"@Mela Digital"})]})]}),g=()=>{let[e,s]=(0,l.useState)(!1),r=()=>{s(e=>!e)};return(0,a.jsxs)("header",{className:"bg-primary text-white",children:[(0,a.jsxs)("div",{className:"container mx-auto flex items-center justify-between px-4 py-3",children:[(0,a.jsx)(f,{}),(0,a.jsx)("nav",{className:"hidden md:flex space-x-4",children:(0,a.jsxs)("a",{href:d.e.githubRepoUrl,className:"hover:underline flex items-center space-x-2",target:"_blank",children:[(0,a.jsx)(x.hL4,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"GitHub"})]})}),(0,a.jsx)("button",{className:"md:hidden text-white focus:outline-none",onClick:r,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})})]}),(0,a.jsxs)("div",{className:"md:hidden fixed top-0 left-0 w-full h-full bg-primary text-white p-4 z-50 transform transition-transform duration-300 ".concat(e?"translate-x-0":"-translate-x-full"),children:[(0,a.jsx)("div",{className:"mb-8",children:(0,a.jsx)(f,{})}),(0,a.jsx)("button",{className:"absolute top-4 right-4 text-white focus:outline-none",onClick:r,children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,a.jsxs)("a",{href:d.e.githubRepoUrl,className:"hover:underline flex items-center space-x-2",target:"_blank",children:[(0,a.jsx)(x.hL4,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"GitHub"})]})]})]})};var j=r(6512),v=r(67087),E=r(40598),b=r(22723),w=r(31468),y=r(15622),N=r(11381);let L=()=>{let[e,s]=(0,l.useState)("");return((0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/connect"),r=await e.json();(null==r?void 0:r.ipAddress)&&s(r.ipAddress)}catch(e){console.error("Failed to fetch IP address:",e)}})()},[]),e)?(0,a.jsx)(y.r,{id:"qrCode",removeQrCodeBehindLogo:!0,logoPadding:0,value:"http://".concat(e,":").concat(document.location.port),logoImage:"/images/file-uploader.png",eyeRadius:7,logoPaddingStyle:"circle",qrStyle:"dots",size:100,logoWidth:22,eyeColor:["#006fee","#006fee","#006fee"],fgColor:"#006fee",style:{borderRadius:8}}):(0,a.jsx)(N.o,{})},R=e=>{let{handleUpload:s,clearUploadedFiles:r,clearAllFiles:l,isUploading:t,selectedFiles:n}=e;return(0,a.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,a.jsx)(E.T,{onPress:s,isLoading:t,isDisabled:t||n.every(e=>e.isUploaded),color:"primary",startContent:(0,a.jsx)(x.HVe,{}),children:t?"Uploading...":"Upload"}),(0,a.jsx)(E.T,{color:"warning",startContent:(0,a.jsx)(x.Gml,{}),className:"text-white",onPress:r,children:"Clear Uploaded"}),(0,a.jsx)(E.T,{color:"danger",startContent:(0,a.jsx)(x.RCe,{}),onPress:l,children:"Clear All"})]})},D=e=>{let{isDragging:s,handleDragEnter:r,handleDragLeave:l,handleDragOver:t,handleDrop:n,handleFileSelect:i}=e;return(0,a.jsx)("div",{className:"flex w-full flex-col",children:(0,a.jsxs)(b.r,{"aria-label":"Options",className:"w-full",color:"primary",classNames:{base:"justify-center"},children:[(0,a.jsx)(w.i,{title:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.ODX,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"File Upload"})]}),children:(0,a.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer text-blue-500",children:(0,a.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-all min-w-[196px] max-w-[400px] mx-auto hover:border-primary-400 ".concat(s?"border-blue-500 bg-blue-100":"border-gray-300"),onDragEnter:r,onDragLeave:l,onDragOver:t,onDrop:n,children:[(0,a.jsx)("p",{className:"text-gray-600",children:s?"Drop files here...":"Drag and drop files here, or"}),(0,a.jsx)("div",{className:"mx-auto my-4 w-16 h-16",children:(0,a.jsx)(m.default,{src:"/images/file-uploader.png",alt:"File upload illustration",width:64,height:64})}),"browse files",(0,a.jsx)("input",{id:"file-upload",type:"file",className:"hidden",onChange:i,multiple:!0})]})})},"fileUpload"),(0,a.jsx)(w.i,{title:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.lWy,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"QR Code"})]}),children:(0,a.jsxs)("div",{className:"border-2 border-dashed border-primary-400 rounded-lg p-6 text-center transition-all min-w-[196px] max-w-[400px] mx-auto",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Scan the QR code below to connect"}),(0,a.jsx)("div",{className:"mx-auto my-4 flex items-center justify-center w-32 h-32",children:(0,a.jsx)(L,{})})]})},"qr")]})})};var _=r(42981),F=r(97381);let I=e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase());function S(e,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return s<=0?"":e.length>s?"".concat(r).concat(e.slice(-s)):e}let T=function(e,s){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(e," ").concat(s).concat(1!==e?r:"")};function O(e){if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),r=e/Math.pow(1024,s);return"".concat(r.toFixed(2)," ").concat(["Bytes","KB","MB","GB","TB"][s])}let A=e=>{let{files:s,removeFile:r}=e;return(0,a.jsx)("ul",{className:"space-y-4",children:s.map((e,s)=>(0,a.jsxs)("li",{className:"p-2 bg-gray-100 rounded shadow text-gray-700",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-gray-700",children:S(e.file.name,12)}),(0,a.jsx)("p",{className:"text-xs text-gray-400",children:O(e.file.size)})]}),(0,a.jsx)(E.T,{isIconOnly:!0,startContent:(0,a.jsx)(F.cW1,{className:"w-6 h-6"}),color:"danger",variant:"faded",onPress:()=>r(e.file.name),className:"p-0 min-w-0 w-auto h-auto rounded-full border-0"})]}),(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)(_.o,{"aria-label":"Loading...",size:"sm",value:e.progress}),(0,a.jsxs)("p",{className:"text-right text-xs text-gray-600",children:[e.progress,"%"]})]})]},s))})},C={FILE_SELECTED:"File selected!",FILE_SELECTED_DETAIL:"You can now upload the file.",FILE_DELETE_ERROR:"Error deleting file",FILE_DELETE_ERROR_DETAIL:"There was an error deleting the file. Please try again.",FILE_UPLOAD_ERROR:"Error uploading file",FILE_UPLOAD_ERROR_DETAIL:"There was an error uploading the file"};var P=r(26718);let U=(0,P.createServerReference)("7f7349d9b71d6cb65c2522e604e77812ccba2cbbb1",P.callServer,void 0,P.findSourceMapURL,"removeFile"),M=(0,P.createServerReference)("7ff1b69de7550c5d713ee964cbdc8efb7122846c9d",P.callServer,void 0,P.findSourceMapURL,"getFileName"),k=e=>{let{selectedFiles:s,refreshFiles:r,setSelectedFiles:t}=e,[n,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),m=(0,l.useRef)(0),{mutate:x}=(0,i.n)({mutationKey:[h.es.REMOVE_FILE],mutationFn:async e=>{let{serverFileName:s}=e;return await U(s)},onError:()=>{(0,j.$U)({title:C.FILE_DELETE_ERROR,description:C.FILE_DELETE_ERROR_DETAIL,color:"danger"})}}),{mutateAsync:u}=(0,i.n)({mutationKey:[h.es.GET_FILE_NAME],mutationFn:async e=>{let{originalName:s}=e;return await M(s)}}),p=e=>{t(s=>{let r=new Set(s.map(e=>e.file.name));return[...e.filter(e=>!r.has(e.name)).map(e=>({file:e,progress:0})),...s]})},f=(0,l.useRef)(new Map),g=async()=>{if(0===s.length)return;d(!0);let e=s.map(e=>e.isUploaded?Promise.resolve():new Promise((s,r)=>{let a=e.file;u({originalName:encodeURIComponent(a.name)}).then(e=>{let l=new XMLHttpRequest;f.current.set(a.name,l),l.open("PUT","/api/upload-file?fileName="+e,!0),l.upload.onprogress=function(s){if(s.lengthComputable){let r=s.loaded/s.total*100;t(s=>s.map(s=>s.file.name===a.name?{...s,progress:Math.round(r),serverFilename:e||void 0}:s))}},l.onload=function(){f.current.delete(a.name),200===l.status?(t(e=>e.map(e=>e.file.name===a.name?{...e,isUploaded:!0}:e)),s()):((0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(a.name,")"),color:"danger"}),r()),0===f.current.size&&d(!1)},l.onerror=function(){f.current.delete(a.name),(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(a.name,")"),color:"danger"}),r(),0===f.current.size&&d(!1)},l.send(a)}).catch(e=>{(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(a.name,")"),color:"danger"}),r(),0===f.current.size&&d(!1)})}));try{await Promise.all(e)}catch(e){console.error("Error uploading files:",e),(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:C.FILE_UPLOAD_ERROR_DETAIL,color:"danger"})}finally{r()}};return(0,a.jsxs)("div",{children:[(0,a.jsx)(D,{handleDragEnter:e=>{e.preventDefault(),e.stopPropagation(),m.current+=1,o(!0)},handleDragLeave:e=>{e.preventDefault(),e.stopPropagation(),m.current-=1,0===m.current&&o(!1)},handleDragOver:e=>{e.preventDefault(),e.stopPropagation()},handleDrop:e=>{e.preventDefault(),e.stopPropagation(),o(!1),p(Array.from(e.dataTransfer.files)),(0,j.$U)({title:C.FILE_SELECTED,description:C.FILE_SELECTED_DETAIL})},handleFileSelect:e=>{p(Array.from(e.target.files||[])),e.target.value="",(0,j.$U)({title:C.FILE_SELECTED,description:C.FILE_SELECTED_DETAIL})},isDragging:n}),(0,a.jsx)("div",{className:"mt-4 h-full overflow-y-auto",children:s.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A,{files:s,removeFile:e=>{let r=f.current.get(e);if(r){var a;r.abort(),f.current.delete(e);let l=null===(a=s.find(s=>s.file.name===e))||void 0===a?void 0:a.serverFilename;l&&x({serverFileName:l})}t(s=>{let r=s.filter(s=>s.file.name!==e);return(0===r.length||0===f.current.size)&&d(!1),r})}}),(0,a.jsx)(R,{handleUpload:g,clearUploadedFiles:()=>{t(e=>e.filter(e=>!e.isUploaded))},clearAllFiles:()=>{f.current.forEach((e,r)=>{var a;let l=null===(a=s.find(e=>e.file.name===r))||void 0===a?void 0:a.serverFilename;l&&x({serverFileName:l}),e.abort()}),f.current.clear(),t([]),d(!1)},isUploading:c,selectedFiles:s})]})})]})},q=()=>(0,a.jsxs)("p",{children:["Visit our"," ",(0,a.jsx)("a",{href:"https://github.com/Mela-Digital/file-uploader/tags",target:"_blank",className:"underline font-bold",children:"GitHub page"})," ","for the latest updates and releases."]}),z=e=>{let{currentVersion:s,latestVersion:r,isChecking:l}=e,t=s<r,n=s>r;return l?null:(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsxs)("div",{className:"bg-yellow-500 text-white p-4 text-center",children:[(0,a.jsxs)("p",{children:["A new version of the app is available! You are using version"," ",(0,a.jsx)("strong",{children:s}),", but the latest version is"," ",(0,a.jsx)("strong",{children:r}),"."]}),(0,a.jsx)(q,{})]}),n&&(0,a.jsxs)("div",{className:"bg-red-500 text-white p-4 text-center",children:[(0,a.jsxs)("p",{children:["You are using an invalid version of the app (",(0,a.jsx)("strong",{children:s}),"). Please reinstall the app to get the latest official version (",(0,a.jsx)("strong",{children:r}),")."]}),(0,a.jsx)(q,{})]})]})};var V=r(54947);let B=e=>{let{permissions:s,isLoading:r}=e;return(0,a.jsx)("div",{className:"container px-4 mx-auto mt-4",children:r?(0,a.jsx)(V.m,{className:"h-4 w-72 rounded-lg my-0.5"}):(0,a.jsxs)("p",{className:"text-sm",children:[(0,a.jsx)("span",{className:"font-semibold",children:"Your permissions:"})," ".concat(s.map(e=>I(e)).join(", "))]})})};var K=r(4540),W=r(79172),G=r(58814),Y=r(16549),H=r(29662),$=r(96232),Q=r(26101),X=r(49632),Z=r(97123);let J=e=>{let s=e.toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp",".svg"].some(e=>s.endsWith(e))};var ee=r(90796);let es=e=>ee.c9.fromISO(e).toRelative(),er=e=>{let{file:s,isLoading:r,canDelete:t,isAddedRecently:n,isShared:i,ipAddress:o,handleDeleteFile:c}=e,{isOpen:d,onOpen:h,onOpenChange:m}=(0,K.j)(),[u,f]=(0,l.useState)(!1),g="".concat(window.location.origin,"?share=").concat(s.name),j=o?"".concat(location.protocol,"//").concat(o,":").concat(location.port,"?share=").concat(s.name):g,b=()=>{navigator.clipboard.writeText(g),f(!0)},w=()=>{window.open(g,"_blank")};return(0,a.jsxs)("li",{className:"p-4 bg-gray-100 rounded-lg shadow-sm flex justify-between items-center cursor-pointer hover:bg-gray-200 gap-1 hover:duration-200 border-b-2 border-b-transparent hover:border-primary-400",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4 ",children:[J(s.name)?(0,a.jsx)("div",{className:"w-12 h-12 flex items-center justify-center bg-gray-200 rounded-md",children:(0,a.jsx)(W.W,{className:"w-12 h-12 object-cover",isZoomed:!0,radius:"md",src:"/api/download/".concat(s.name),alt:"Preview image"})}):(0,a.jsx)("div",{className:"w-12 h-12 flex items-center justify-center bg-gray-200 rounded-md border border-primary-200 group",children:(0,a.jsx)("p",{className:"text-xs font-bold text-primary-500 group-hover:scale-125 group-hover:duration-300 transform",children:function(e){let s=e.split(".");return s.length>1&&s.pop()||""}(s.name)})}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)("span",{className:"font-medium text-sm text-gray-700",children:S(s.name,12)}),(0,a.jsxs)("p",{className:"text-xs text-gray-400",children:[n&&(0,a.jsxs)("span",{children:[(0,a.jsx)("span",{className:"text-success",children:"Added recently"})," -"," "]}),"".concat(O(s.size)," - ").concat(es(s.createdAt))]})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[!i&&(0,a.jsx)(G.I,{className:"capitalize",content:"Share file",placement:"top",closeDelay:100,showArrow:!0,children:(0,a.jsx)(E.T,{isIconOnly:!0,isDisabled:!t,isLoading:r,onPress:h,children:(0,a.jsx)(x.Zzu,{className:"w-6 h-6"})})}),(0,a.jsx)(G.I,{className:"capitalize",content:"Delete file",placement:"top",color:"danger",closeDelay:100,showArrow:!0,children:(0,a.jsx)(E.T,{isIconOnly:!0,isDisabled:!t,isLoading:r,onPress:t?()=>c(s.name):void 0,color:"danger",children:(0,a.jsx)(v.Tqh,{className:"w-6 h-6"})})}),(0,a.jsx)(G.I,{className:"capitalize",content:"Download file",placement:"top",color:"primary",closeDelay:100,showArrow:!0,children:(0,a.jsx)(E.T,{isIconOnly:!0,color:"primary",as:p(),href:"/api/download/".concat(s.name),rel:"noopener noreferrer",download:!0,children:(0,a.jsx)(v.kvS,{className:"w-6 h-6"})})})]}),(0,a.jsx)(Y.Y,{isOpen:d,onOpenChange:m,children:(0,a.jsx)(H.g,{children:e=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)($.c,{className:"flex flex-col gap-1",children:"Share file"}),(0,a.jsx)(Q.h,{children:(0,a.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,a.jsx)("p",{children:j}),(0,a.jsx)("div",{children:(0,a.jsx)(y.r,{id:"qrCode",removeQrCodeBehindLogo:!0,logoPadding:0,value:j,logoImage:"/images/file-uploader.png",eyeRadius:7,logoPaddingStyle:"circle",qrStyle:"dots",size:192,logoWidth:22,eyeColor:["#006fee","#006fee","#006fee"],fgColor:"#006fee",style:{borderRadius:8}})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(E.T,{startContent:(0,a.jsx)(x.paH,{className:"w-4 h-4"}),onPress:b,children:u?"Copied!":"Copy to clipboard"}),(0,a.jsx)(E.T,{startContent:(0,a.jsx)(Z.qRQ,{className:"w-5 h-5"}),onPress:w,children:"Open in new tab"})]})]})}),(0,a.jsx)(X.q,{children:(0,a.jsx)(E.T,{color:"primary",onPress:e,children:"Close"})})]})})})]})};var ea=r(38426);let el=e=>{let{handleNextPage:s,handlePageChange:r,handlePreviousPage:l,page:t,totalPages:n}=e;return(0,a.jsxs)("div",{className:"flex justify-center mt-4 space-x-2",children:[(0,a.jsx)(E.T,{onPress:l,isDisabled:1===t,startContent:(0,a.jsx)(ea.YvZ,{className:"w-5 h-5"}),isIconOnly:!0}),(()=>{let e=[],s=Math.max(1,t-1),r=Math.min(n,t+1);for(let a=s;a<=r;a++)e.push(a);return e.length<3&&(e[0]>1?e.unshift(e[0]-1):e[e.length-1]<n&&e.push(e[e.length-1]+1)),e})().map(e=>(0,a.jsx)(E.T,{onPress:()=>r(e),isIconOnly:!0,color:t===e?"primary":"default",children:e},e)),(0,a.jsx)(E.T,{onPress:s,isDisabled:t===n,endContent:(0,a.jsx)(ea.B_2,{className:"w-5 h-5"}),isIconOnly:!0})]})},et=()=>{let e=Array.from({length:10});return(0,a.jsx)("div",{className:"flex flex-col gap-4",children:e.map((e,s)=>(0,a.jsxs)("li",{className:"p-4 bg-gray-100 rounded-lg shadow-sm flex justify-between items-center cursor-pointer gap-1 border-b-2 border-b-transparent hover:border-primary-400",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,a.jsx)(V.m,{className:"rounded-md",children:(0,a.jsx)("div",{className:"w-12 h-12 bg-gray-200"})}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)(V.m,{className:"h-3 w-5/6 rounded-lg",children:(0,a.jsx)("p",{children:"Lorem ipsum dolor sit."})}),(0,a.jsx)(V.m,{className:"h-3 w-3/5 rounded-lg",children:(0,a.jsx)("p",{children:"Lorem, ipsum dolor."})})]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(V.m,{className:"w-10 h-10 rounded-lg"}),(0,a.jsx)(V.m,{className:"w-10 h-10 rounded-lg"}),(0,a.jsx)(V.m,{className:"w-10 h-10 rounded-lg"})]})]},s))})},en=(0,P.createServerReference)("7f59626d1b8aa4d38cd75f749a582176472f36f77f",P.callServer,void 0,P.findSourceMapURL,"getLatestVersion"),ei=(0,P.createServerReference)("7fe07a746f6ccc5e220f2ca687ac9aabed5ab07418",P.callServer,void 0,P.findSourceMapURL,"getFiles"),eo=(0,P.createServerReference)("7fa33b0393e9f77ee70b63f132bc738a130931299b",P.callServer,void 0,P.findSourceMapURL,"getDownloadLink"),ec=(0,P.createServerReference)("7f6c494d0aecab11e0c9ab5d834c98050665a4e9c7",P.callServer,void 0,P.findSourceMapURL,"deleteFile"),ed=(0,P.createServerReference)("7fb1a79418667c0d207d55a1dbbdd92e7022c3be49",P.callServer,void 0,P.findSourceMapURL,"getConnectionStatus"),eh=e=>(Array.isArray(e)||(e=[e]),h.Jj.filter(s=>!e.includes(s))),em=()=>{let{isFetching:e,data:s}=(0,n.I)({queryKey:[h.es.APP_CONNECT],queryFn:ed}),r=(null==s?void 0:s.ok)?eh([]):eh([h.aX.DELETE]);return{hasPermission:e=>r.includes(e),permissions:r,isFetchingConnectData:e,ipAddress:(null==s?void 0:s.ipAddress)||null}},ex=()=>{let e=(0,c.useSearchParams)().get("share"),[s,r]=(0,l.useState)(1),[m,x]=(0,l.useState)([]),{hasPermission:u,permissions:p,isFetchingConnectData:f,ipAddress:j}=em(),v=(0,t.jE)(),b=(0,l.useRef)(""),{data:w,isFetching:y}=(0,n.I)({queryKey:[h.es.LATEST_VERSION],staleTime:h.uB.CHECKING_LATEST_VERSION,queryFn:en}),{data:N,isFetching:L}=(0,n.I)({queryKey:[h.es.FILES,s],queryFn:async()=>await ei(s),staleTime:0}),{data:R}=(0,n.I)({queryKey:[h.es.VERIFY_DOWNLOAD_LINK,e],enabled:!!e,queryFn:async()=>await eo(null!=e?e:"")}),{mutateAsync:D,isPending:_}=(0,i.n)({mutationKey:[h.es.DELETE_FILE],mutationFn:async e=>{let{fileName:s}=e;return await ec(s)}}),F=(null==N?void 0:N.files)||[],I=(null==N?void 0:N.totalPages)||0,S=u(h.aX.DELETE),O=(null==N?void 0:N.total)||0,A=()=>{v.invalidateQueries({queryKey:[h.es.FILES,s]})},C=async e=>{b.current=e,await D({fileName:e})&&A(),b.current=""};return(0,a.jsxs)("div",{className:"bg-white h-screen flex flex-col md:overflow-hidden",children:[(0,a.jsx)(g,{}),(0,a.jsx)(z,{currentVersion:d.e.version,latestVersion:w,isChecking:y}),(0,a.jsx)(B,{permissions:p,isLoading:f}),(0,a.jsx)("div",{className:"flex-1 w-full xl:container mx-auto p-4 md:overflow-hidden",children:(0,a.jsxs)("div",{className:"flex h-full w-full rounded-lg md:overflow-hidden shadow-lg border border-gray-200 flex-col md:flex-row",children:[(0,a.jsx)("div",{className:"w-full md:w-1/3 lg:w-1/4 p-4 border-b md:border-b-0 md:border-r border-gray-200 bg-gray-50 md:overflow-y-auto",children:(0,a.jsx)(k,{selectedFiles:m,setSelectedFiles:x,refreshFiles:A})}),(0,a.jsxs)("div",{className:"flex-1 p-4 bg-white md:overflow-y-auto",children:[R&&(0,a.jsxs)("div",{className:"flex flex-col mb-4 gap-2",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Shared file"}),(0,a.jsx)(er,{file:{createdAt:new Date().toISOString(),name:e||"",size:204800},isLoading:!1,canDelete:S,isShared:!0,handleDeleteFile:C})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Browse Your Files"}),y?(0,a.jsx)(V.m,{className:"h-3 w-52 rounded-lg my-1"}):(0,a.jsx)("p",{className:"text-sm text-gray-400",children:"".concat(T(O,"file"),", ").concat(T(I,"page"))})]}),(0,a.jsx)(G.I,{className:"capitalize",content:"Refresh files",placement:"left",color:"primary",closeDelay:100,showArrow:!0,children:(0,a.jsx)(E.T,{isIconOnly:!0,color:"primary",onPress:A,children:(0,a.jsx)(o.gkI,{className:"w-6 h-6"})})})]}),L?(0,a.jsx)(et,{}):(0,a.jsx)("ul",{className:"space-y-4",children:F.map((e,s)=>{let r=b.current===e.name&&_,l=m.some(s=>s.serverFilename===e.name);return(0,a.jsx)(er,{file:e,isLoading:r,canDelete:S,handleDeleteFile:C,isAddedRecently:l,ipAddress:j},s)})}),!!F.length&&(0,a.jsx)(el,{handleNextPage:()=>{s<I&&r(s+1)},handlePageChange:e=>r(e),handlePreviousPage:()=>{s>1&&r(s-1)},page:s,totalPages:I})]})]})})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[294,789,196,581,148,22,52,775,258,826,563,223,429,358],()=>s(79537)),_N_E=e.O()}]);