(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{55371:(e,s,a)=>{"use strict";a.d(s,{e:()=>n});let r=JSON.parse('{"rE":"0.0.18","h_":"Support for multiple file types and sizes"}');var l,t=a(15240);let n={name:"File Uploader",description:r.h_,version:r.rE,githubOrgUrl:"https://github.com/Mela-Digital",githubRepoUrl:"https://github.com/Mela-Digital/file-uploader"};t.env.UPLOADED_FOLDER},57765:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>ep});var r=a(12694),l=a(63478),t=a(72849),n=a(77028),i=a(11387),o=a(83034),c=a(1660),d=a(55371),m=a(90603),h=a(13431),x=a(79630),u=a(47515),p=a.n(u);let f=()=>(0,r.jsxs)("div",{children:[(0,r.jsx)(p(),{href:"/",children:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(h.default,{src:"/images/file-uploader.png",alt:"Logo",width:32,height:32,className:"filter brightness-400"}),(0,r.jsx)("h1",{className:"text-xl font-bold",children:"File Uploader"})]})}),(0,r.jsxs)("p",{className:"text-xs",children:["Version: ",d.e.version," by"," ",(0,r.jsx)("a",{className:"hover:underline font-bold",href:d.e.githubOrgUrl,target:"_blank",children:"@Mela Digital"})]})]}),g=()=>{let[e,s]=(0,l.useState)(!1),a=()=>{s(e=>!e)};return(0,r.jsxs)("header",{className:"bg-primary text-white",children:[(0,r.jsxs)("div",{className:"container mx-auto flex items-center justify-between px-4 py-3",children:[(0,r.jsx)(f,{}),(0,r.jsx)("nav",{className:"hidden md:flex space-x-4",children:(0,r.jsxs)("a",{href:d.e.githubRepoUrl,className:"hover:underline flex items-center space-x-2",target:"_blank",children:[(0,r.jsx)(x.hL4,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"GitHub"})]})}),(0,r.jsx)("button",{className:"md:hidden text-white focus:outline-none",onClick:a,children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16m-7 6h7"})})})]}),(0,r.jsxs)("div",{className:"md:hidden fixed top-0 left-0 w-full h-full bg-primary text-white p-4 z-50 transform transition-transform duration-300 ".concat(e?"translate-x-0":"-translate-x-full"),children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)(f,{})}),(0,r.jsx)("button",{className:"absolute top-4 right-4 text-white focus:outline-none",onClick:a,children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),(0,r.jsxs)("a",{href:d.e.githubRepoUrl,className:"hover:underline flex items-center space-x-2",target:"_blank",children:[(0,r.jsx)(x.hL4,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"GitHub"})]})]})]})};var j=a(6512),v=a(67087),w=a(40598),E=a(22723),N=a(31468),y=a(15622),b=a(11381);let L=()=>{let[e,s]=(0,l.useState)("");return((0,l.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/connect"),a=await e.json();(null==a?void 0:a.ipAddress)&&s(a.ipAddress)}catch(e){console.error("Failed to fetch IP address:",e)}})()},[]),e)?(0,r.jsx)(y.r,{id:"qrCode",removeQrCodeBehindLogo:!0,logoPadding:0,value:"http://".concat(e,":").concat(document.location.port),logoImage:"/images/file-uploader.png",eyeRadius:7,logoPaddingStyle:"circle",qrStyle:"dots",size:100,logoWidth:22,eyeColor:["#006fee","#006fee","#006fee"],fgColor:"#006fee",style:{borderRadius:8}}):(0,r.jsx)(b.o,{})},R=e=>{let{handleUpload:s,clearUploadedFiles:a,clearAllFiles:l,isUploading:t,selectedFiles:n}=e;return(0,r.jsxs)("div",{className:"mt-4 flex flex-col gap-2",children:[(0,r.jsx)(w.T,{onPress:s,isLoading:t,isDisabled:t||n.every(e=>e.isUploaded),color:"primary",startContent:(0,r.jsx)(x.HVe,{}),children:t?"Uploading...":"Upload"}),(0,r.jsx)(w.T,{color:"warning",startContent:(0,r.jsx)(x.Gml,{}),className:"text-white",onPress:a,children:"Clear Uploaded"}),(0,r.jsx)(w.T,{color:"danger",startContent:(0,r.jsx)(x.RCe,{}),onPress:l,children:"Clear All"})]})},D=e=>{let{isDragging:s,handleDragEnter:a,handleDragLeave:l,handleDragOver:t,handleDrop:n,handleFileSelect:i}=e;return(0,r.jsx)("div",{className:"flex w-full flex-col",children:(0,r.jsxs)(E.r,{"aria-label":"Options",className:"w-full",color:"primary",classNames:{base:"justify-center"},children:[(0,r.jsx)(N.i,{title:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(v.ODX,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"File Upload"})]}),children:(0,r.jsx)("label",{htmlFor:"file-upload",className:"cursor-pointer text-blue-500",children:(0,r.jsxs)("div",{className:"border-2 border-dashed rounded-lg p-6 text-center transition-all min-w-[196px] max-w-[400px] mx-auto hover:border-primary-400 ".concat(s?"border-blue-500 bg-blue-100":"border-gray-300"),onDragEnter:a,onDragLeave:l,onDragOver:t,onDrop:n,children:[(0,r.jsx)("p",{className:"text-gray-600",children:s?"Drop files here...":"Drag and drop files here, or"}),(0,r.jsx)("div",{className:"mx-auto my-4 w-16 h-16",children:(0,r.jsx)(h.default,{src:"/images/file-uploader.png",alt:"File upload illustration",width:64,height:64})}),"browse files",(0,r.jsx)("input",{id:"file-upload",type:"file",className:"hidden",onChange:i,multiple:!0})]})})},"fileUpload"),(0,r.jsx)(N.i,{title:(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(v.lWy,{className:"w-5 h-5"}),(0,r.jsx)("span",{children:"QR Code"})]}),children:(0,r.jsxs)("div",{className:"border-2 border-dashed border-primary-400 rounded-lg p-6 text-center transition-all min-w-[196px] max-w-[400px] mx-auto",children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Scan the QR code below to connect"}),(0,r.jsx)("div",{className:"mx-auto my-4 flex items-center justify-center w-32 h-32",children:(0,r.jsx)(L,{})})]})},"qr")]})})};var _=a(42981),F=a(97381);let O=e=>e.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase());function I(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"...";return s<=0?"":e.length>s?"".concat(a).concat(e.slice(-s)):e}let A=function(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"s";return"".concat(e," ").concat(s).concat(1!==e?a:"")};function T(e){if(0===e)return"0 Bytes";let s=Math.floor(Math.log(e)/Math.log(1024)),a=e/Math.pow(1024,s);return"".concat(a.toFixed(2)," ").concat(["Bytes","KB","MB","GB","TB"][s])}let S=e=>{let{files:s,removeFile:a}=e;return(0,r.jsx)("ul",{className:"space-y-4",children:s.map((e,s)=>(0,r.jsxs)("li",{className:"p-2 bg-gray-100 rounded shadow text-gray-700",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"font-medium text-sm text-gray-700",children:I(e.file.name,12)}),(0,r.jsx)("p",{className:"text-xs text-gray-400",children:T(e.file.size)})]}),(0,r.jsx)(w.T,{isIconOnly:!0,startContent:(0,r.jsx)(F.cW1,{className:"w-6 h-6"}),color:"danger",variant:"faded",onPress:()=>a(e.file.name),className:"p-0 min-w-0 w-auto h-auto rounded-full border-0"})]}),(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(_.o,{"aria-label":"Loading...",size:"sm",value:e.progress}),(0,r.jsxs)("p",{className:"text-right text-xs text-gray-600",children:[e.progress,"%"]})]})]},s))})},C={FILE_SELECTED:"File selected!",FILE_SELECTED_DETAIL:"You can now upload the file.",FILE_DELETE_ERROR:"Error deleting file",FILE_DELETE_ERROR_DETAIL:"There was an error deleting the file. Please try again.",FILE_UPLOAD_ERROR:"Error uploading file",FILE_UPLOAD_ERROR_DETAIL:"There was an error uploading the file",FILE_DOWNLOAD_ERROR:"Error downloading file",FILE_DOWNLOAD_ERROR_DETAIL:"There was an error downloading the file"};var P=a(26718);let U=(0,P.createServerReference)("7f696367c3bfec49add3543abe7991eb6f3cf645e8",P.callServer,void 0,P.findSourceMapURL,"removeFile"),M=(0,P.createServerReference)("7fb3182f028b9ca858876ad741a5fa48c28db1b0fc",P.callServer,void 0,P.findSourceMapURL,"getFileName"),k=e=>{let{selectedFiles:s,refreshFiles:a,setSelectedFiles:t}=e,[n,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!1),h=(0,l.useRef)(0),{mutate:x}=(0,i.n)({mutationKey:[m.es.REMOVE_FILE],mutationFn:async e=>{let{serverFileName:s}=e;return await U(s)},onError:()=>{(0,j.$U)({title:C.FILE_DELETE_ERROR,description:C.FILE_DELETE_ERROR_DETAIL,color:"danger"})}}),{mutateAsync:u}=(0,i.n)({mutationKey:[m.es.GET_FILE_NAME],mutationFn:async e=>{let{originalName:s}=e;return await M(s)}}),p=e=>{t(s=>{let a=new Set(s.map(e=>e.file.name));return[...e.filter(e=>!a.has(e.name)).map(e=>({file:e,progress:0})),...s]})},f=(0,l.useRef)(new Map),g=async()=>{if(0===s.length)return;d(!0);let e=s.map(e=>e.isUploaded?Promise.resolve():new Promise((s,a)=>{let r=e.file;u({originalName:encodeURIComponent(r.name)}).then(e=>{let l=new XMLHttpRequest;f.current.set(r.name,l),l.open("PUT","/api/upload-file?fileName="+e,!0),l.upload.onprogress=function(s){if(s.lengthComputable){let a=s.loaded/s.total*100;t(s=>s.map(s=>s.file.name===r.name?{...s,progress:Math.round(a),serverFilename:e||void 0}:s))}},l.onload=function(){f.current.delete(r.name),200===l.status?(t(e=>e.map(e=>e.file.name===r.name?{...e,isUploaded:!0}:e)),s()):((0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(r.name,")"),color:"danger"}),a()),0===f.current.size&&d(!1)},l.onerror=function(){f.current.delete(r.name),(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(r.name,")"),color:"danger"}),a(),0===f.current.size&&d(!1)},l.send(r)}).catch(e=>{(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:"".concat(C.FILE_UPLOAD_ERROR_DETAIL,": (").concat(r.name,")"),color:"danger"}),a(),0===f.current.size&&d(!1)})}));try{await Promise.all(e)}catch(e){console.error("Error uploading files:",e),(0,j.$U)({title:C.FILE_UPLOAD_ERROR,description:C.FILE_UPLOAD_ERROR_DETAIL,color:"danger"})}finally{a()}};return(0,r.jsxs)("div",{children:[(0,r.jsx)(D,{handleDragEnter:e=>{e.preventDefault(),e.stopPropagation(),h.current+=1,o(!0)},handleDragLeave:e=>{e.preventDefault(),e.stopPropagation(),h.current-=1,0===h.current&&o(!1)},handleDragOver:e=>{e.preventDefault(),e.stopPropagation()},handleDrop:e=>{e.preventDefault(),e.stopPropagation(),o(!1),p(Array.from(e.dataTransfer.files)),(0,j.$U)({title:C.FILE_SELECTED,description:C.FILE_SELECTED_DETAIL})},handleFileSelect:e=>{p(Array.from(e.target.files||[])),e.target.value="",(0,j.$U)({title:C.FILE_SELECTED,description:C.FILE_SELECTED_DETAIL})},isDragging:n}),(0,r.jsx)("div",{className:"mt-4 h-full overflow-y-auto",children:s.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S,{files:s,removeFile:e=>{let a=f.current.get(e);if(a){var r;a.abort(),f.current.delete(e);let l=null===(r=s.find(s=>s.file.name===e))||void 0===r?void 0:r.serverFilename;l&&x({serverFileName:l})}t(s=>{let a=s.filter(s=>s.file.name!==e);return(0===a.length||0===f.current.size)&&d(!1),a})}}),(0,r.jsx)(R,{handleUpload:g,clearUploadedFiles:()=>{t(e=>e.filter(e=>!e.isUploaded))},clearAllFiles:()=>{f.current.forEach((e,a)=>{var r;let l=null===(r=s.find(e=>e.file.name===a))||void 0===r?void 0:r.serverFilename;l&&x({serverFileName:l}),e.abort()}),f.current.clear(),t([]),d(!1)},isUploading:c,selectedFiles:s})]})})]})},z=()=>(0,r.jsxs)("p",{children:["Visit our"," ",(0,r.jsx)("a",{href:"https://github.com/Mela-Digital/file-uploader/tags",target:"_blank",className:"underline font-bold",children:"GitHub page"})," ","for the latest updates and releases."]}),W=e=>{let{currentVersion:s,latestVersion:a,isChecking:l}=e,t=s<a,n=s>a;return l?null:(0,r.jsxs)(r.Fragment,{children:[t&&(0,r.jsxs)("div",{className:"bg-yellow-500 text-white p-4 text-center",children:[(0,r.jsxs)("p",{children:["A new version of the app is available! You are using version"," ",(0,r.jsx)("strong",{children:s}),", but the latest version is"," ",(0,r.jsx)("strong",{children:a}),"."]}),(0,r.jsx)(z,{})]}),n&&(0,r.jsxs)("div",{className:"bg-red-500 text-white p-4 text-center",children:[(0,r.jsxs)("p",{children:["You are using an invalid version of the app (",(0,r.jsx)("strong",{children:s}),"). Please reinstall the app to get the latest official version (",(0,r.jsx)("strong",{children:a}),")."]}),(0,r.jsx)(z,{})]})]})};var q=a(54947);let V=e=>{let{permissions:s,isLoading:a}=e;return(0,r.jsx)("div",{className:"container px-4 mx-auto mt-4",children:a?(0,r.jsx)(q.m,{className:"h-4 w-72 rounded-lg my-0.5"}):(0,r.jsxs)("p",{className:"text-sm",children:[(0,r.jsx)("span",{className:"font-semibold",children:"Your permissions:"})," ".concat(s.map(e=>O(e)).join(", "))]})})};var B=a(4540),K=a(79172),Y=a(58814),$=a(16549),G=a(29662),H=a(96232),Q=a(26101),X=a(49632),Z=a(97123),J=a(19672);let ee=e=>{let s=e.toLowerCase();return[".jpg",".jpeg",".png",".gif",".webp",".svg"].some(e=>s.endsWith(e))},es=e=>{let s=e.toLowerCase();return[".mp4",".mov",".avi",".mkv",".webm"].some(e=>s.endsWith(e))};var ea=a(90796);let er=e=>ea.c9.fromISO(e).toRelative(),el=(0,P.createServerReference)("7fbff45105ca35258732f8956d4c152ce98ff6ad2c",P.callServer,void 0,P.findSourceMapURL,"getDownloadLink"),et=e=>{let{file:s,isLoading:a,canDelete:t,isAddedRecently:n,isShared:o,ipAddress:c,handleDeleteFile:d}=e,{isOpen:h,onOpen:u,onOpenChange:p}=(0,B.j)(),[f,g]=(0,l.useState)(!1),[E,N]=(0,l.useState)(!1),{isOpen:b,onOpen:L,onOpenChange:R}=(0,B.j)(),D="".concat(window.location.origin,"?share=").concat(s.name),_=c?"".concat(location.protocol,"//").concat(c,":").concat(location.port,"?share=").concat(s.name):D,F=()=>{navigator.clipboard.writeText(D),g(!0)},O=()=>{window.open(D,"_blank")},{mutateAsync:A}=(0,i.n)({mutationFn:async()=>{var e;return await el(null!==(e=s.name)&&void 0!==e?e:"")},mutationKey:[m.es.VERIFY_DOWNLOAD_LINK,{fileName:s.name}]}),S=async()=>{try{if(N(!0),!await A()){(0,j.$U)({title:C.FILE_DOWNLOAD_ERROR,description:C.FILE_DOWNLOAD_ERROR_DETAIL,color:"danger"});return}let e=document.createElement("a");e.href="/api/download/".concat(s.name,"1"),e.download=s.name,document.body.appendChild(e),e.click(),document.body.removeChild(e)}catch(e){(0,j.$U)({title:C.FILE_DOWNLOAD_ERROR,description:C.FILE_DOWNLOAD_ERROR_DETAIL,color:"danger"})}finally{N(!1)}};return(0,r.jsxs)("li",{className:"p-2 sm:p-4 bg-gray-100 rounded-lg shadow-sm flex justify-between items-center cursor-pointer hover:bg-gray-200 gap-1 hover:duration-200 border-b-2 border-b-transparent hover:border-primary-400",onClick:L,children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[ee(s.name)?(0,r.jsx)("div",{className:"w-8 h-8 sm:w-12 sm:h-12 flex items-center justify-center bg-gray-200 rounded-md transition-all duration-300 ease-in-out",children:(0,r.jsx)(K.W,{className:"w-8 h-8 sm:w-12 sm:h-12 object-cover transition-all duration-300 ease-in-out",isZoomed:!0,radius:"md",src:"/api/download/".concat(s.name),alt:"Preview image"})}):(0,r.jsx)("div",{className:"w-12 h-12 flex items-center justify-center bg-gray-200 rounded-md border border-primary-200 group",children:(0,r.jsx)("p",{className:"text-xs font-bold text-primary-500 group-hover:scale-125 group-hover:duration-300 transform",children:function(e){let s=e.split(".");return s.length>1&&s.pop()||""}(s.name)})}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("span",{className:"font-medium text-sm text-gray-700 truncate",children:I(s.name,12)}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:[n&&(0,r.jsxs)("span",{children:[(0,r.jsx)("span",{className:"text-success",children:"Added recently"})," -"," "]}),"".concat(T(s.size)," - ").concat(er(s.createdAt))]})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[!o&&(0,r.jsx)(Y.I,{className:"capitalize",content:"Share file",placement:"top",closeDelay:100,showArrow:!0,children:(0,r.jsx)(w.T,{isIconOnly:!0,isDisabled:!t,isLoading:a,onPress:u,className:"w-8 h-8 min-w-8 sm:w-10 sm:h-10 sm:min-w-10 transition-all duration-300 ease-in-out",children:(0,r.jsx)(x.Zzu,{className:"w-4 h-4 sm:w-6 sm:h-6"})})}),(0,r.jsx)(Y.I,{className:"capitalize",content:"Delete file",placement:"top",color:"danger",closeDelay:100,showArrow:!0,children:(0,r.jsx)(w.T,{isIconOnly:!0,isDisabled:!t,isLoading:a,onPress:t?()=>d(s.name):void 0,color:"danger",className:"w-8 h-8 min-w-8 sm:w-10 sm:h-10 sm:min-w-10 transition-all duration-300 ease-in-out",children:(0,r.jsx)(v.Tqh,{className:"w-4 h-4 sm:w-6 sm:h-6"})})}),(0,r.jsx)(Y.I,{className:"capitalize",content:"Download file",placement:"top",color:"primary",closeDelay:100,showArrow:!0,children:(0,r.jsx)(w.T,{isIconOnly:!0,color:"primary",onPress:S,className:"w-8 h-8 min-w-8 sm:w-10 sm:h-10 sm:min-w-10 transition-all duration-300 ease-in-out",isLoading:E,children:(0,r.jsx)(v.kvS,{className:"w-4 h-4 sm:w-6 sm:h-6"})})})]}),(0,r.jsx)($.Y,{isOpen:h,onOpenChange:p,children:(0,r.jsx)(G.g,{children:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.c,{className:"flex flex-col gap-1",children:"Share file"}),(0,r.jsx)(Q.h,{children:(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsx)("p",{children:_}),(0,r.jsx)("div",{children:(0,r.jsx)(y.r,{id:"qrCode",removeQrCodeBehindLogo:!0,logoPadding:0,value:_,logoImage:"/images/file-uploader.png",eyeRadius:7,logoPaddingStyle:"circle",qrStyle:"dots",size:192,logoWidth:22,eyeColor:["#006fee","#006fee","#006fee"],fgColor:"#006fee",style:{borderRadius:8}})}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(w.T,{startContent:(0,r.jsx)(x.paH,{className:"w-4 h-4"}),onPress:F,children:f?"Copied!":"Copy to clipboard"}),(0,r.jsx)(w.T,{startContent:(0,r.jsx)(Z.qRQ,{className:"w-5 h-5"}),onPress:O,children:"Open in new tab"})]})]})}),(0,r.jsx)(X.q,{children:(0,r.jsx)(w.T,{color:"primary",onPress:e,children:"Close"})})]})})}),(0,r.jsx)($.Y,{isOpen:b,size:"full",scrollBehavior:"inside",onOpenChange:R,children:(0,r.jsx)(G.g,{children:e=>{let a=!ee(s.name)&&!es(s.name);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(H.c,{className:"flex flex-col gap-1",children:"File preview"}),(0,r.jsxs)(Q.h,{children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsxs)("span",{className:"font-medium text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-bold",children:"File name: "}),s.name]}),(0,r.jsxs)("p",{className:"text-xs text-gray-400",children:[(0,r.jsxs)("span",{className:"font-bold text-gray-700",children:["File size:"," "]}),"".concat(T(s.size)," - "),(0,r.jsxs)("span",{className:"font-bold text-gray-700",children:["Last uploaded:"," "]}),"".concat(er(s.createdAt))]})]}),(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[ee(s.name)&&(0,r.jsx)(K.W,{className:"object-cover",radius:"md",src:"/api/download/".concat(s.name),alt:"Preview image"}),es(s.name)&&(0,r.jsx)("video",{className:"max-h-[80vh] rounded-lg",controls:!0,src:"/api/files/".concat(s.name),children:"Your browser does not support the video tag."}),a&&(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center gap-4 mt-4",children:[(0,r.jsx)(J.OH1,{className:"w-16 h-16 text-gray-400"}),(0,r.jsx)("p",{className:"text-gray-400",children:"Cannot preview this file type."})]})]})]}),(0,r.jsx)(X.q,{children:(0,r.jsx)(w.T,{color:"primary",onPress:e,children:"Close"})})]})}})})]})};var en=a(38426);let ei=e=>{let{handleNextPage:s,handlePageChange:a,handlePreviousPage:l,page:t,totalPages:n}=e;return(0,r.jsxs)("div",{className:"flex justify-center mt-4 space-x-2",children:[(0,r.jsx)(w.T,{onPress:l,isDisabled:1===t,startContent:(0,r.jsx)(en.YvZ,{className:"w-5 h-5"}),isIconOnly:!0}),(()=>{let e=[],s=Math.max(1,t-1),a=Math.min(n,t+1);for(let r=s;r<=a;r++)e.push(r);return e.length<3&&(e[0]>1?e.unshift(e[0]-1):e[e.length-1]<n&&e.push(e[e.length-1]+1)),e})().map(e=>(0,r.jsx)(w.T,{onPress:()=>a(e),isIconOnly:!0,color:t===e?"primary":"default",children:e},e)),(0,r.jsx)(w.T,{onPress:s,isDisabled:t===n,endContent:(0,r.jsx)(en.B_2,{className:"w-5 h-5"}),isIconOnly:!0})]})},eo=()=>{let e=Array.from({length:10});return(0,r.jsx)("div",{className:"flex flex-col gap-4",children:e.map((e,s)=>(0,r.jsxs)("li",{className:"p-4 bg-gray-100 rounded-lg shadow-sm flex justify-between items-center cursor-pointer gap-1 border-b-2 border-b-transparent hover:border-primary-400",children:[(0,r.jsxs)("div",{className:"flex items-center justify-center space-x-4",children:[(0,r.jsx)(q.m,{className:"rounded-md",children:(0,r.jsx)("div",{className:"w-12 h-12 bg-gray-200"})}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(q.m,{className:"h-3 w-5/6 rounded-lg",children:(0,r.jsx)("p",{children:"Lorem ipsum dolor sit."})}),(0,r.jsx)(q.m,{className:"h-3 w-3/5 rounded-lg",children:(0,r.jsx)("p",{children:"Lorem, ipsum dolor."})})]})]}),(0,r.jsxs)("div",{className:"flex space-x-2",children:[(0,r.jsx)(q.m,{className:"w-10 h-10 rounded-lg"}),(0,r.jsx)(q.m,{className:"w-10 h-10 rounded-lg"}),(0,r.jsx)(q.m,{className:"w-10 h-10 rounded-lg"})]})]},s))})},ec=(0,P.createServerReference)("7f8e22eca9e4c3b49ed1b704d69304cff90b3d9007",P.callServer,void 0,P.findSourceMapURL,"getLatestVersion"),ed=(0,P.createServerReference)("7f9dedc3ede3ad99754573ac0e89c417893a2f3af2",P.callServer,void 0,P.findSourceMapURL,"getFiles"),em=(0,P.createServerReference)("7ff823e9a6f07391e8fb6c358038a82147a590d9e6",P.callServer,void 0,P.findSourceMapURL,"deleteFile"),eh=(0,P.createServerReference)("7f069e83286998c665c668d14c4020e3def2ebb104",P.callServer,void 0,P.findSourceMapURL,"getConnectionStatus"),ex=e=>(Array.isArray(e)||(e=[e]),m.Jj.filter(s=>!e.includes(s))),eu=()=>{let{isFetching:e,data:s}=(0,n.I)({queryKey:[m.es.APP_CONNECT],queryFn:eh}),a=(null==s?void 0:s.ok)?ex([]):ex([m.aX.DELETE]);return{hasPermission:e=>a.includes(e),permissions:a,isFetchingConnectData:e,ipAddress:(null==s?void 0:s.ipAddress)||null}},ep=()=>{let e=(0,c.useSearchParams)().get("share"),[s,a]=(0,l.useState)(1),[h,x]=(0,l.useState)([]),{hasPermission:u,permissions:p,isFetchingConnectData:f,ipAddress:j}=eu(),v=(0,t.jE)(),E=(0,l.useRef)(""),{data:N,isFetching:y}=(0,n.I)({queryKey:[m.es.LATEST_VERSION],staleTime:m.uB.CHECKING_LATEST_VERSION,queryFn:ec}),{data:b,isFetching:L}=(0,n.I)({queryKey:[m.es.FILES,s],queryFn:async()=>await ed(s),staleTime:0}),{data:R,refetch:D}=(0,n.I)({queryKey:[m.es.VERIFY_DOWNLOAD_LINK,e],enabled:!!e,queryFn:async()=>await el(null!=e?e:"")}),{mutateAsync:_,isPending:F}=(0,i.n)({mutationKey:[m.es.DELETE_FILE],mutationFn:async e=>{let{fileName:s}=e;return await em(s)}}),O=(null==b?void 0:b.files)||[],I=(null==b?void 0:b.totalPages)||0,T=u(m.aX.DELETE),S=(null==b?void 0:b.total)||0,C=()=>{v.invalidateQueries({queryKey:[m.es.FILES,s]})},P=async s=>{E.current=s,await _({fileName:s})&&(C(),e&&D()),E.current=""};return(0,r.jsxs)("div",{className:"bg-white h-screen flex flex-col md:overflow-hidden",children:[(0,r.jsx)(g,{}),(0,r.jsx)(W,{currentVersion:d.e.version,latestVersion:N,isChecking:y}),(0,r.jsx)(V,{permissions:p,isLoading:f}),(0,r.jsx)("div",{className:"flex-1 w-full xl:container mx-auto p-4 md:overflow-hidden",children:(0,r.jsxs)("div",{className:"flex h-full w-full rounded-lg md:overflow-hidden shadow-lg border border-gray-200 flex-col md:flex-row",children:[(0,r.jsx)("div",{className:"w-full md:w-1/3 lg:w-1/4 p-4 border-b md:border-b-0 md:border-r border-gray-200 bg-gray-50 md:overflow-y-auto",children:(0,r.jsx)(k,{selectedFiles:h,setSelectedFiles:x,refreshFiles:C})}),(0,r.jsxs)("div",{className:"flex-1 p-4 bg-white md:overflow-y-auto",children:[R&&(0,r.jsxs)("div",{className:"flex flex-col mb-4 gap-2",children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Shared file"}),(0,r.jsx)(et,{file:{createdAt:new Date().toISOString(),name:e||"",size:204800},isLoading:!1,canDelete:T,isShared:!0,handleDeleteFile:P})]}),(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-bold text-gray-800",children:"Browse Your Files"}),y?(0,r.jsx)(q.m,{className:"h-3 w-52 rounded-lg my-1"}):(0,r.jsx)("p",{className:"text-sm text-gray-400",children:"".concat(A(S,"file"),", ").concat(A(I,"page"))})]}),(0,r.jsx)(Y.I,{className:"capitalize",content:"Refresh files",placement:"left",color:"primary",closeDelay:100,showArrow:!0,children:(0,r.jsx)(w.T,{isIconOnly:!0,color:"primary",isLoading:L,onPress:C,children:(0,r.jsx)(o.gkI,{className:"w-6 h-6"})})})]}),L?(0,r.jsx)(eo,{}):(0,r.jsx)("ul",{className:"space-y-4",children:O.map((e,s)=>{let a=E.current===e.name&&F,l=h.some(s=>s.serverFilename===e.name);return(0,r.jsx)(et,{file:e,isLoading:a,canDelete:T,handleDeleteFile:P,isAddedRecently:l,ipAddress:j},s)})}),!!O.length&&(0,r.jsx)(ei,{handleNextPage:()=>{s<I&&a(s+1)},handlePageChange:e=>a(e),handlePreviousPage:()=>{s>1&&a(s-1)},page:s,totalPages:I})]})]})})]})}},79537:(e,s,a)=>{Promise.resolve().then(a.bind(a,57765))},90603:(e,s,a)=>{"use strict";a.d(s,{Jj:()=>n,aX:()=>t,es:()=>r,uB:()=>l});let r={LATEST_VERSION:"latestVersion",FILES:"files",DELETE_FILE:"deleteFile",APP_CONNECT:"appConnect",REMOVE_FILE:"removeFile",GET_FILE_NAME:"getFileName",VERIFY_DOWNLOAD_LINK:"verifyDownloadLink"},l={DEFAULT_STALE_TIME:6e4,CHECKING_LATEST_VERSION:6e5};var t=function(e){return e.READ="read",e.WRITE="write",e.DELETE="delete",e.UPLOAD="upload",e}({});let n=["read","write","delete","upload"]}},e=>{var s=s=>e(e.s=s);e.O(0,[294,789,196,154,581,148,22,52,775,258,826,563,223,429,358],()=>s(79537)),_N_E=e.O()}]);